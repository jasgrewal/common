type(ds_new_fit)
typeof(ds_new_fit)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE, tidy.opts=list(width.cutoff=80),tidy=TRUE)
data_raw = read.table("ILS_ISS_saline_HTSeq_nostats.txt", header=TRUE, stringsAsFactors=FALSE)
covariates = read.table("ILS_ISS_saline_HTSeq_nostats_covars.txt", header=TRUE, stringsAsFactors=FALSE)
head(rownames(data_raw))
colnames(data_raw)
rownames(covariates)
library(DESeq2)
library(ggplot2)
library(biomaRt)
library(knitr)
print(dim(data_raw))
kable(head(data_raw))
kable(covariates)
data_clean = data_raw[as.logical(rowSums(data_raw != 0)), ]
dim(data_clean)
data=data_clean[,row.names(covariates)]
covariates$Strain = factor(covariates$Strain, levels=c('ILS','ISS'))
dds_counts <- DESeqDataSetFromMatrix(countData=data, colData=covariates, design=~Strain)
ds_fit <- DESeq(dds_counts)
rld <- rlogTransformation(ds_fit, blind=TRUE)
vsd <- varianceStabilizingTransformation(ds_fit, blind=TRUE)
DESeq2::plotPCA(rld, intgroup=c("Strain"))  + theme_bw() + geom_text(aes(label=colnames(rld)))
covariates_new = covariates[rownames(covariates)!="ILS_S_2_B",]
kable(covariates_new)
data_new = data_clean[,rownames(covariates_new)]
data_new = data_new[as.logical(rowSums(data_new != 0)), ]
print(dim(data_new))
dds_new_counts <- DESeqDataSetFromMatrix(countData=data_new, colData=covariates_new, design=~Strain)
ds_new_fit <- DESeq(dds_new_counts)
rld_new <- rlogTransformation(ds_new_fit, blind=TRUE)
typeof(ds_new_fit)
res = results(ds_new_fit)
kable(head(res))
print(paste("Total genes are", dim(res)[1], sep=": "))
print(paste("Gene with p-value 'NA'", dim(res[is.na(res$pvalue),])[1],  sep=": "))
res_nofilter = results(ds_new_fit, independentFiltering = FALSE)
print(paste("Total genes are", dim(res_nofilter)[1], sep=": "))
print(paste("Gene with p-value 'NA'", dim(res_nofilter[is.na(res_nofilter$pvalue),])[1],  sep=": "))
rownames((res[is.na(res$pvalue), ]))
genes_NA = rownames(res[is.na(res$pvalue), ])
genecounts_NA = data_new[genes_NA,]
genecounts_NA
rdat=petals
data(petals)
data(precipt)
data(precip)
precip
head(precip)
typeof(precip)
dim(precip)
?datasets
library(help = "datasets")
data(PlantGrowth)
head(PlantGrowth)
dim(PlantGrowth)
colnames(PlantGrowth)
rownmaes(PlantGrowth)
rownames(PlantGrowth)
View(PlantGrowth)
head(PlantGrowth)
data_raw = read.table("ILS_ISS_saline_HTSeq_nostats.txt", header=TRUE, stringsAsFactors=FALSE)
covariates = read.table("ILS_ISS_saline_HTSeq_nostats_covars.txt", header=TRUE, stringsAsFactors=FALSE)
head(rownames(data_raw))
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE, tidy.opts=list(width.cutoff=80),tidy=TRUE)
